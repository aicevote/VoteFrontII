(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{299:function(e,t){},307:function(e,t,r){"use strict";r.r(t);r(267),r(16);var n=r(2),o=(r(271),r(69)),c=r(273),m=r.n(c),l=r(266),h=l.c.reactiveProp,v={extends:l.a,mixins:[h],props:["options"],mounted:function(){this.renderChart(this.chartData,this.options)}},d=l.c.reactiveProp,f={extends:l.b,mixins:[d],props:["options"],mounted:function(){this.renderChart(this.chartData,this.options)}},_=["rgba(255, 99, 132, 0.2)","rgba(255, 159, 64, 0.2)","rgba(255, 205, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(54, 162, 235, 0.2)","rgba(153, 102, 255, 0.2)","rgba(201, 203, 207, 0.2)"],C=["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(153, 102, 255)","rgb(201, 203, 207)"];function x(title,e,t){return{labels:e,datasets:[{label:title,backgroundColor:_,borderColor:C,borderWidth:1,fill:!1,data:t}]}}function w(e,t){return{labels:(t=t.reverse()).map((function(e){return new Date(e.timestamp)})),datasets:e.map((function(r,i){return{label:r,backgroundColor:_[i],borderColor:C[i],borderWidth:1,fill:!0,data:i==e.length-1?new Array(t.length).fill(100):t.map((function(e){return e.percentage.filter((function(e,t){return t<=i})).reduce((function(pre,e){return pre+e}))}))}}))}}var D={components:{BarChart:v,LineChart:f},data:function(){return{message:"",commentResult:0,barOptions:{responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}},lineOptions:{responsive:!0,scales:{xAxes:[{type:"time"}],yAxes:[{ticks:{beginAtZero:!0}}]}}}},methods:{comment:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=e.$store.state.session.sessionToken)){t.next=4;break}return e.commentResult=401,t.abrupt("return");case 4:return t.prev=4,t.next=7,o.comment(e.theme.themeID,r,e.message);case 7:t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(4),e.commentResult=400,t.abrupt("return");case 13:e.commentResult=200;case 14:case"end":return t.stop()}}),t,null,[[4,9]])})))()},getUserInfo:function(e,t){return this.users.find((function(r){return r.userProvider==e&&r.userID==t}))}},computed:{isSignedIn:function(){return null!=this.$store.state.session.sessionToken}},mounted:function(){var e=this;this.websocket.on("result",(function(t){e.theme.themeID==t.themeID&&(e.result=x(e.theme.title,e.theme.choices,t.results))})),this.websocket.on("comments",(function(t){var r=e.theme.themeID,n=t.comments.filter((function(e){return e.themeID==r})).sort((function(a,b){return a.createdAt=b.createdAt}));e.comments=n+e.comments}))},asyncData:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,c,l,h,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=parseInt(e.route.hash.slice(2),10),t.next=4,o.getTheme(r);case 4:return n=t.sent,t.next=7,o.getResult(r);case 7:return c=t.sent,t.next=10,o.getTransition(r);case 10:return l=t.sent,t.next=13,o.getComments(r);case 13:return h=t.sent,t.next=16,o.getProfiles(h.map((function(e){return{userID:e.userID,userProvider:e.userProvider}})));case 16:return v=t.sent,t.abrupt("return",{theme:n,shortTransition:w(n.choices,l.shortTransition),longTransition:w(n.choices,l.longTransition),comments:h.reverse(),users:v,result:x(n.title,n.choices,c.results),websocket:m()("https://api.aicevote.com")});case 20:t.prev=20,t.t0=t.catch(0),e.error({statusCode:404,message:"This page could not be found"});case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))()}},k=r(29),component=Object(k.a)(D,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v(e._s(e.theme.title))]),e._v(" "),r("p",[e._v(e._s(e.theme.description))]),e._v(" "),r("h2",[e._v("Result")]),e._v(" "),r("bar-chart",{staticClass:"pure-u-1 pure-u-md-2-3 pure-u-lg-1-2",attrs:{"chart-data":e.result,options:e.barOptions}}),e._v(" "),r("h2",[e._v("Transition")]),e._v(" "),r("div",{staticClass:"pure-u-1 pure-u-md-1-3 pure-u-lg-10-24"},[r("h3",[e._v("Short term")]),e._v(" "),r("line-chart",{attrs:{"chart-data":e.shortTransition,options:e.lineOptions}})],1),e._v(" "),r("div",{staticClass:"pure-u-1 pure-u-md-1-3 pure-u-lg-10-24"},[r("h3",[e._v("Long term")]),e._v(" "),r("line-chart",{attrs:{"chart-data":e.longTransition,options:e.lineOptions}})],1),e._v(" "),r("h2",[e._v("Comments")]),e._v(" "),1==e.isSignedIn?r("div",[r("form",{staticClass:"pure-form"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{placeholder:"New comment",required:""},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}}),e._v(" "),r("button",{staticClass:"pure-button pure-button-primary",on:{click:function(t){return t.preventDefault(),e.comment()}}},[r("fa-icon",{staticClass:"fa-fw",attrs:{icon:["fas","comment"]}}),e._v("Â Comment\n      ")],1)]),e._v(" "),0==e.commentResult?r("p"):e._e(),e._v(" "),200==e.commentResult?r("p",[e._v("Success! You commented!")]):e._e(),e._v(" "),400==e.commentResult?r("p",[e._v("Sorry, failed to comment...")]):e._e(),e._v(" "),401==e.commentResult?r("p",[e._v("Please sign in to comment")]):e._e()]):e._e(),e._v(" "),r("table",{staticClass:"pure-table"},[e._m(0),e._v(" "),r("tbody",e._l(e.comments,(function(t){return r("tr",{key:t.createdAt},[r("td",[r("img",{staticClass:"pure-img",attrs:{alt:"User icon",src:e.getUserInfo(t.userProvider,t.userID).imageURI}})]),e._v(" "),r("td",[e._v(e._s(e.getUserInfo(t.userProvider,t.userID).name))]),e._v(" "),r("td",[e._v(e._s(t.message))]),e._v(" "),r("td",[e._v(e._s(new Date(t.createdAt).toDateString()))])])})),0)])],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("#")]),this._v(" "),t("th",[this._v("Name")]),this._v(" "),t("th",[this._v("Comment")]),this._v(" "),t("th",[this._v("Date")])])])}],!1,null,null,null);t.default=component.exports}}]);